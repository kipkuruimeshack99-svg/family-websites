<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Register - Family Website</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f0f4f8; margin:0; padding:0; }
    header { background: linear-gradient(90deg, #007BFF, #00C6FF); color:#fff; padding:10px 0; }
    nav { width:90%; margin:auto; display:flex; justify-content:space-between; align-items:center; }
    nav ul { list-style:none; display:flex; gap:15px; }
    nav ul li a { color:#fff; text-decoration:none; padding:6px 12px; border-radius:4px; }
    nav ul li a:hover { background: rgba(255,255,255,0.2); }
    .auth-container { width:90%; max-width:400px; margin:50px auto; background:#fff; padding:20px; border-radius:8px; box-shadow:0 4px 10px rgba(0,0,0,0.1); }
    h2 { text-align:center; color:#007BFF; margin-bottom:20px; }
    label { display:block; margin:10px 0 5px; }
    input, select { width:100%; padding:10px; margin-bottom:10px; border-radius:6px; border:1px solid #ccc; }
    .btn { display:block; width:100%; padding:12px; margin-top:10px; background:linear-gradient(90deg, #007BFF, #00C6FF); color:#fff; border:none; border-radius:25px; cursor:pointer; font-size:1rem; }
    .btn:hover { opacity:0.9; }
    p { text-align:center; margin-top:15px; }
    #server-message { display:none; padding:12px; border-radius:6px; margin:12px 0; }
  </style>
</head>
<body>

  <div id="server-message"></div>

  <header>
    <nav>
      <h1 class="logo">Welcome to our Family Website</h1>
      <ul class="nav-links">
        <li><a href="index.html">Home</a></li>
        <li><a href="login.html" class="btn">Login</a></li>
      </ul>
    </nav>
  </header>

  <div class="auth-container">
    <h2>Create Account</h2>
    <form id="registerForm" action="register.php" method="post">
      <label for="firstname">First Name</label>
      <input type="text" id="firstname" name="first_name" required>

      <label for="surname">Surname</label>
      <input type="text" id="surname" name="last_name" required>

      <label for="familyname">Family Name (Calling Name)</label>
      <input type="text" id="familyname" name="unique_name" required>

      <label for="email">Email (optional)</label>
      <input type="email" id="email" name="email">

      <label for="phone">Phone Number</label>
      <input type="tel" id="phone" name="phone" required>

      <label for="password">Create Password</label>
      <input type="password" id="password" name="password" required>

      <label for="confirm">Confirm Password</label>
      <input type="password" id="confirm" name="confirm" required>

      <label for="relation">Relation</label>
      <select id="relation" name="relation" required>
        <option value="">-- Select Category --</option>
        <option value="unemployed">Unemployed (Looking for Job)</option>
        <option value="student">Student</option>
        <option value="employed">Employed</option>
        <option value="other">Other</option>
      </select>

      <button type="submit" class="btn">Submit</button>
    </form>

    <p>Already have an account? <a href="login.html">Login</a></p>
  </div>

  <script>
  // Display server messages (success or error)
  (function(){
    const params = new URLSearchParams(window.location.search);
    const status = params.get('status');
    const msg = params.get('msg');
    if (!status || !msg) return;
    const el = document.getElementById('server-message');
    el.textContent = decodeURIComponent(msg).split('|').join('\n');
    el.style.display = 'block';
    if (status === 'success') {
      el.style.background = '#e6ffed';
      el.style.border = '1px solid #12a454';
      el.style.color = '#03592a';
    } else {
      el.style.background = '#fff0f0';
      el.style.border = '1px solid #d33';
      el.style.color = '#600';
    }
  })();

  // Optional client-side validation
  document.getElementById('registerForm').addEventListener('submit', function(e){
    const password = document.getElementById('password').value;
    const confirm = document.getElementById('confirm').value;
    const allowedNames = ["kakipsin","tuimereng","chelogam","komosi","chibweri","kapsato","chemesek","chemamul"];
    const familyname = document.getElementById('familyname').value.trim().toLowerCase();

    if (!allowedNames.includes(familyname)) {
      e.preventDefault();
      alert("Sorry, only family members with approved calling names can register.");
      return;
    }

    if (password !== confirm) {
      e.preventDefault();
      alert("Passwords do not match!");
      return;
    }
    // Let form submit to register.php if valid
  });
  </script>

</body>
</html>
